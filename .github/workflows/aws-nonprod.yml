name: Deploy to Amazon ECS (NonProd)

on: workflow_dispatch

permissions:
  contents: read

jobs:
  deploy-librarian:
    uses: ./.github/workflows/build-and-deploy.yml
    with:
      ecr-repository: frontend-librarian
      ecs-service: frontend-librarian
      ecs-task-definition: librarian/.aws/taskdefinition-nonprod.json
      container-name: frontend-librarian
      ecs-cluster: geekway-nonprod
      folder-name: librarian
      always-override-limit: false
      auth-callback: http://nonprod-alb-609305099.us-east-1.elb.amazonaws.com/librarian
      logout-return-url: http://nonprod-alb-609305099.us-east-1.elb.amazonaws.com/librarian
    secrets: inherit
  deploy-admin:
    uses: ./.github/workflows/build-and-deploy.yml
    with:
      ecr-repository: frontend-admin
      ecs-service: frontend-admin
      ecs-task-definition: board-game-admin/.aws/taskdefinition-nonprod.json
      container-name: frontend-admin
      ecs-cluster: geekway-nonprod
      folder-name: board-game-admin
      always-override-limit: false
      auth-callback: http://nonprod-alb-609305099.us-east-1.elb.amazonaws.com/admin
      logout-return-url: http://nonprod-alb-609305099.us-east-1.elb.amazonaws.com/admin
    secrets: inherit
  deploy-play-and-win:
    uses: ./.github/workflows/build-and-deploy.yml
    with:
      ecr-repository: frontend-playandwin
      ecs-service: frontend-playandwin
      ecs-task-definition: play-prize-entry/.aws/taskdefinition-nonprod.json
      container-name: frontend-play-and-win
      ecs-cluster: geekway-nonprod
      folder-name: play-prize-entry
      always-override-limit: false
      auth-callback: http://nonprod-alb-609305099.us-east-1.elb.amazonaws.com/playandwin
      logout-return-url: http://nonprod-alb-609305099.us-east-1.elb.amazonaws.com/playandwin
    secrets: inherit
